/**
* Ctrip JavaScript Code
* http://m.ctrip.com/
* Copyright(C) 2008 - 2014, Ctrip All rights reserved.
* Date:2014_11_07 14:06:02
*/
define("cWebMember",["cUserModel","cUtilValidate","cUtilPath","cUtilCryptBase64","cCommonStore"],function(a,b,c,d,e){"use strict";var f=window.location.host,g="accounts.ctrip.com";f.match(/^m\.ctrip\.com/i)?g="accounts.ctrip.com":f.match(/.uat\.qa/i)?g="accounts.uat.qa.nt.ctripcorp.com":f.match(/.fat/i)||f.match(/.fws/i)?g="accounts.fat49.qa.nt.ctripcorp.com":f.match(/^(localhost|172\.16|127\.0)/i)&&(g="accounts.fat49.qa.nt.ctripcorp.com");var h={MEMBER_LOGIN:"https://"+g+"/H5Login/#login",REGISTER:"https://"+g+"/H5Register/"},i=function(a,d){var e=a,f=location,g=d&&d.param&&"string"==typeof d.param?d.param:"";if(g){g=c.getUrlParams(d.param);var h=g&&g.backurl?decodeURIComponent(g.backurl):"",i=g&&g.from?decodeURIComponent(g.from):"",j=f.protocol+"//"+f.host;b.isUrl(h)?g.backurl=h:""!==h&&(g.backurl=j+h),b.isUrl(i)?g.from=i:""!==i&&(g.from=j+i);var k=$.param(g);""!=k&&(e=e+"?"+k)}window.location.href=e},j={memberLogin:function(a){i(h.MEMBER_LOGIN,a)},nonMemberLogin:function(b){var c=a.NotUserLoginModel.getInstance();b=_.extend({callback:function(){}},b||{}),c.excute(b.callback,b.callback)},register:function(a){i(h.REGISTER,a)},autoLogin:function(b){var f,g=b.url||window.location.href,h=c.getUrlParam(g,"__token__"),i=e.UserStore.getInstance(),j=(e.HeadStore.getInstance(),this);if(h){try{var k=d.Base64.decode(decodeURIComponent(h));f=JSON.parse(k)}catch(l){return void(b.callback&&b.callback())}var m=function(){i.removeUser(),i.setAuth(f.auth);var c=a.UserLoginModel.getInstance();c.param={Auth:f.auth};var d=function(a){a.UserID&&(a.Auth=f.auth,a.LoginName=a.LoginName||"",delete a.ResponseStatus,delete a.Result,i.setUser(a),i.setExpireTime(f.time)),b.callback&&b.callback()},e=function(){j.memberLogin()};c.excute(d,e)};i.getAuth()===f.auth?i.isNonUser()?m():b.callback&&b.callback():i.getAuth()!==f.auth&&m()}else b.callback&&b.callback()},app_finished_login:function(){return!1}};return j}),define("cWebAppInit",["cBaseInit","cWebMember"],function(a,b){b.autoLogin({callback:function(){require([],function(){a()})}})}),define("cWebApp",["cUtilPath","cCoreInherit","cAbstractApp","cUtilPath"],function(a,b,c,d){return b.Class(c,{bindEvents:function($super){$super(),$(window).bind("popstate",_.bind(function(a){var b=a.state||a.originalEvent&&a.originalEvent.state;b.options&&(b.options.pushState=!1,b.options.landingpage=0,b.options.hideloading=!0),!Lizard.stopStateWatch&&b&&(history.replaceState({url:b.url,text:b.text,options:b.options},document.title,b.url),this.showView(b),Lizard.__fakeViewNode&&Lizard.__fakeViewNode.remove())},this))},start:function(){var b=a.parseUrl(location.href).pathname;b="/"==b?"/index":location.href.substring(location.href.indexOf(a.parseUrl(location.href).pathname)),history.replaceState({url:b,text:document.documentElement.innerHTML,options:{pushState:!1,renderAt:Lizard.renderAt,landingpage:1,hideloading:Lizard.config.isFirstPageHideLoading}},document.title,b),this.loadView(b,document.documentElement.innerHTML,{pushState:!1,renderAt:Lizard.renderAt,landingpage:1,hideloading:Lizard.config.isFirstPageHideLoading})},goTo:function(a,b){var c=this;if(b&&b.viewName&&Lizard.viewHtmlMap[b.viewName]){var d=!0;return b.pushState===!1?(d=!1,history.replaceState({url:a,text:Lizard.viewHtmlMap[b.viewName],options:{pushState:!1}},document.title,a)):history.pushState({url:a,text:Lizard.viewHtmlMap[b.viewName],options:{pushState:!0}},document.title,a),void this.loadView(a,Lizard.viewHtmlMap[b.viewName],{pushState:d})}$.get(a,b?b.data:{},function(e){b&&b.pushState===!1?(d=!1,history.replaceState({url:a,text:e,options:{pushState:!1}},document.title,a)):history.pushState({url:a,text:e,options:{pushState:!0}},document.title,a),c.loadView(a,e,{pushState:!0})})},goBack:function(){0==arguments.length?history.back():this.goTo.apply(this,arguments)},judgeForward:function(a){var b=d.parseUrl(window.location.protocol+"//"+window.location.host+(0==a.indexOf("/")?a:"/"+a)),c=new RegExp(b.pathname+"$");return c.test(window.location.pathname)}})}),define("UIHeader",["UIView",getAppUITemplatePath("ui.header")],function(a,b){return _.inherit(a,{propertys:function($super){$super(),this.template=b,this.events={"click #c-ui-header-home":"homeAction","click #c-ui-header-tel":"telAction","click #c-ui-header-return":"backAction","click .c-ui-header-btn":"commitAction","click .icon_search_w":"searchAction"},this.datamodel&&this.datamodel.events&&_.isFunction(this.datamodel.events.customHandler)&&(this.events["click #"+this.datamodel.btn.id]="customerAction")},initialize:function($super,a){$super(a),this.rootBox=this.wrapper=a.root,this.show()},show:function($super){this.wrapper.empty(),$super()},createRoot:function(a){this.$el=$(a)},initElement:function(){this.root=this.wrapper},set:function(a){_.extend(this.datamodel,a),this.refresh(!0),this.show()},updateHeader:function(a,b){this.set(_.isObject(a)?a:_.object([a],[b]))},homeAction:function(){this.datamodel.events.homeHandler.call(this.datamodel.view||this)},telAction:function(){},backAction:function(){this.datamodel.events.returnHandler.call(this.datamodel.view||this)},commitAction:function(){this.datamodel.events.commitHandler.call(this.datamodel.view||this)},searchAction:function(){this.datamodel.events.searchHandler.call(this.datamodel.view||this)},customerAction:function(){this.datamodel.events.customHandler.call(this.datamodel.view||this)}})}),define("cWebGuider",[],function(){"use strict";var a={jump:function(a){a&&a.url&&"string"==typeof a.url&&(window.location.href=a.url)},apply:function(a){a&&a.callback&&"function"==typeof a.callback&&a.callback()},call:function(a){var b=document.getElementById("h5-hybrid-caller");return a&&a.url?void(b&&b.src==a.url?b.contentDocument.location.reload():b&&b.src!=a.url?b.src=a.url:(b=document.createElement("iframe"),b.id="h5-hybrid-caller",b.src=a.url,b.style.display="none",document.body.appendChild(b))):!1},log:function(a){window.console&&window.console.log(a.name)},print:function(a){return 0},callService:function(){window.location.href="tel:4000086666"},backToLastPage:function(){window.location.href=document.referrer},home:function(){window.location.href="/"}};return a}),define("cWebGeolocation",["cGeoHelper","cUtilPerformance","cModel","cCoreInherit"],function(a,b,c,d){var e={},f="0b895f63ca21c9e82eb158f46fe7f502";e.isInOverseas=!1;var g=d.Class(c,{__propertys__:function(){this.url="http://m.ctrip.com/restapi/soa2/10398/json/LBSLocateCity"}}).getInstance();return e.showMapWithPOI=function(b){function c(a,b,c,d){this.point_=a,this.name_=b,this.map_=c,this.div_=d,this.setMap&&this.setMap(c)}var d=function(b){function d(a,b,d){function e(a,b,d){var e=$("<DIV/>").addClass("map-content");d||$("<IMG/>").attr({src:"http://res.m.ctrip.com/html5/Content/images/map_address.png"}).appendTo(e),a.content&&$("<SPAN/>").html(a.content).appendTo(e);var f;if(d){f=new i.maps.Marker({position:new i.maps.LatLng(a.lat,a.lng),map:b,icon:"http://res.m.ctrip.com/html5/Content/images/map_address.png",id:a.markerId}),a.id&&""!=a.id&&b.setCenter(new i.maps.LatLng(a.lat,a.lng));var h=new c(new i.maps.LatLng(a.lat,a.lng),a.content,b,e[0]);g.marekrs.push(f),g.overlays.push(h),a.callBack&&i.maps.event.addListener(f,"click",function(){a.callBack(a.markerId)})}else f=new AMap.Marker({position:new AMap.LngLat(a.lng,a.lat),map:b,id:a.markerId}),a.id&&""!=a.id&&b.setCenter(new AMap.LngLat(a.lng,a.lat)),f.setContent(e[0]),a.callBack&&AMap.event.addListener(f,"click",function(){a.callBack(a.markerId)})}if(a instanceof Array&&a.length>0)for(var f=0;f<a.length;f++){var h=a[f];if(!h||!h.lat||!h.lng)break;e(h,b,d)}else e(a,b,d)}if(!(b&&b.lat&&b.lng&&b.id))return b.error&&b.error(),!1;var f,g={marekrs:[],overlays:[]},h=!1,i=window.google,j=a.getCountry(b.lng,b.lat);if((1!=j||e.isInOverseas)&&i&&i.maps&&i.maps.LatLng)h=!0,i.maps.OverlayView&&(c.prototype=new i.maps.OverlayView,c.prototype.onAdd=function(){var a=this.getPanes();a.overlayImage.appendChild(this.div_)},c.prototype.draw=function(){var a=this.getProjection(),b=a.fromLatLngToDivPixel(this.point_),c=this.div_;if(c){c.style.left=b.x+20+"px",c.style.top=b.y-50+"px",c.style.position="absolute";var d=c.children[0];d&&(d.style.bottom="0px",d.style.left="0px")}},c.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_),this.div_=null});else if(!AMap)return b.error&&b.error(),!1;var k,l=13;if(h)k=new i.maps.Map(document.getElementById(b.id),{center:new i.maps.LatLng(b.lat,b.lng),zoom:b.level||l,zoomControl:!0});else{k=new AMap.Map(b.id,{center:new AMap.LngLat(b.lng,b.lat),level:b.level||l});var m=null,n=function(a){m=new AMap.TileLayer({tileUrl:"http://mt{1,2,3,0}.google.cn/vt/lyrs=m@142&hl=zh-CN&gl=cn&x=[x]&y=[y]&z=[z]&s=Galil"}),m.setMap(a)};(1!=j||e.isInOverseas)&&n(k)}return b.zoomCallBack&&(h?i.maps.event.addListener(k,"zoom_changed",function(){var a=b.zoomCallBack&&b.zoomCallBack(this.getZoom());if(a){if(g.marekrs&&g.marekrs.length>0){for(var c=0;c<g.marekrs.length;c++)g.overlays[c].setMap&&g.overlays[c].setMap(null),g.marekrs[c].setMap&&g.marekrs[c].setMap(null);g={marekrs:[],overlays:[]}}d(a,this,h)}}):AMap.event.addListener(k,"zoomchange",function(){var a=b.zoomCallBack&&b.zoomCallBack(this.getZoom());a&&(this.clearMap(),d(a,this,h))})),f=b.markers instanceof Array&&b.markers.length>0?b.markers:b,d(f,k,h),k};return d(b)},e.showMapWithPOIList=function(){},e.requestCityInfo=function(a,c,d,f,h,i,j){var k={number:b.getUuid(),detail:b.getUuid(),city:b.getUuid(),error:b.getUuid()};for(var l in k)b.group(k[l],{name:"GeoRequest",url:"Web function "+l});var m=function(f){b.groupEnd(k.number);var l=f.coords.longitude,m=f.coords.latitude;d&&d(l,m);var n=function(c){b.groupEnd(k.detail),_.isFunction(i)&&(g.setAttr("param",{Longitude:l,Latitude:m,CountryName:c.country,ProvinceName:c.province,L1CityName:c.city,L2CityName:c.district,TownName:"",Language:"CN"}),g.excute(function(a){b.groupEnd(k.city),i(a)},function(a){b.groupTag(k.error,"errno","23"),b.groupEnd(k.error),j&&j(a)})),a&&a(c)},o=function(){b.groupTag(k.error,"errno","21"),b.groupEnd(k.error),c&&c()};h?e.tansformLongitude(l,m,function(a,b){e.requestAMapAddress(a,b,n,o)},function(){b.groupTag(k.error,"errno","22"),b.groupEnd(k.error),c&&c()}):e.requestAMapAddress(l,m,n,o)},n=function(a,d){return b.groupTag(k.error,"errno","20"),b.groupEnd(k.error),"function"==typeof f?void f(d,a):void(c&&c(d))};this.requestGeographic(m,n)},e.requestGeographic=function(c,d,f){var g=b.getUuid();b.group(g,{name:"GeoRequest",url:"Google service",type:"Google service"});var h=function(a,b,c){var d=document.createElement("script"),e=document.write;d.type="text/javascript",d.readyState?d.onreadystatechange=function(){("loaded"==d.readyState||"complete"==d.readyState)&&(d.onreadystatechange=null,document.write=e,c&&b&&b())}:(d.onload=function(){document.write=e,c&&b&&b()},d.onerror=function(){document.write=e}),d.src=a,document.write=function(a){var b=a.match(/http(s)?:\/\/[A-Za-z0-9]+[\.\/=\?%\-&_~`@[\]\:+!]*([^<>])*(\.js)/);b&&h(b[0],function(){document.write=e},!0)},document.body.appendChild(d)},i=function(d){b.groupEnd(g),c&&c(d);var f=d.coords.longitude,i=d.coords.latitude,j=a.getCountry(f,i);2==j?(e.isInOverseas=!0,"undefined"==typeof google&&h("https://maps.googleapis.com/maps/api/js?v=3&region=zh-CN")):e.isInOverseas=!1},j=function(a){b.groupEnd(g);var c="未能获取到您当前位置，请重试或选择城市";switch(a.code){case a.TIMEOUT:c="获取您当前位置超时，请重试或选择城市！";break;case a.PERMISSION_DENIED:c="您拒绝了使用位置共享服务，查询已取消，请开启位置共享或选择城市！";break;case a.POSITION_UNAVAILABLE:c="获取您当前位置信息失败，请重试或选择城市！"}d&&d(a,c)};window.navigator&&window.navigator.geolocation?window.navigator.geolocation.getCurrentPosition(i,j,{enableHighAccuracy:!0,maximumAge:5e3,timeout:f||2e4}):d&&d("","获取您当前位置信息失败，浏览器不支持定位！")},e.tansformLongitude=function(c,d,e,g,h){var i=b.getUuid();b.group(i,{name:"GeoRequest",url:"http://restapi.amap.com/v3/assistant/coordinate/convert",type:"AMap service"});var j=a.getCountry(c,d);if(1!=j)return b.groupEnd(i),void e(c,d);var k=$.param({locations:c+","+d,key:f,coordsys:"gps"});h=h||8e3,$.ajax({url:"http://restapi.amap.com/v3/assistant/coordinate/convert?"+k,dataType:"jsonp",success:function(a){if(b.groupEnd(i),a&&"1"===a.status){var c=a.locations.split(",");e&&e(c[0],c[1])}else g&&g()},error:function(a){b.groupEnd(i),g&&g(a)},timeout:h})},e.requestAMapAddress=function(c,d,e,g,h){function i(a,b){if(1==b){var e=a&&a.regeocode||"",f=e.addressComponent.city,g=e.addressComponent.province,h=e.addressComponent.district,i="";return _.isString(f)?i=f:_.isString(g)&&(i=g),{address:_.isString(e.formatted_address)?e.formatted_address:"",location:k,info:e&&e.addressComponent,city:i,province:g,district:h,lng:c,lat:d,country:"中国",countryShortName:"CHN"}}if(a&&"OK"===a.status){var h="",i="",j="",g="",l="";if(!a.results)return!1;var m=a.results[0]||{};return _.find(m.address_components,function(a){var b=a&&a.long_name;a.types&&("country"==a.types[0]&&"political"==a.types[1]&&(j=b,l=a.short_name),"administrative_area_level_1"===a.types[0]&&"political"===a.types[1]&&(g=b),"locality"===a.types[0]&&"political"===a.types[1]&&(i=b),"administrative_area_level_2"===a.types[0]&&"political"===a.types[1]&&(h=b),"sublocality_level_1"===a.types[0]&&"sublocality"===a.types[1]&&(h=b))}),""==j&&""==g&&""==i&&""==h?!1:{address:_.isString(a.results[0].formatted_address)?a.results[0].formatted_address:"",location:k,info:a.results[0].address_components,lng:c,lat:d,country:j,province:g,city:i,district:h,countryShortName:l}}return!1}var j=b.getUuid();b.group(j,{name:"GeoRequest",url:"http://restapi.amap.com/v3/geocode/regeo",type:"AMap service"});var k="121.473704,31.230393",l=1;c&&d&&(k=c+","+d,l=a.getCountry(c,d)),h=h||8e3;var m=1==l?"http://restapi.amap.com/v3/geocode/regeo?"+$.param({location:k,key:f,radius:0,extensions:"all"}):"https://maps.googleapis.com/maps/api/geocode/json?"+$.param({latlng:d+","+c,sensor:!1});$.ajax({url:m,dataType:1==l?"jsonp":"json",success:function(a){b.groupEnd(j);var c=i(a,l);_.isObject(c)?e&&e(i(a,l)):g&&g(a)},error:function(a){b.groupEnd(j),g&&g(a)},timeout:h})},e});